<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map" ng-app='bae-synchronous' ng-controller="MainController"></div>
    <script>
      var map;
      var markers = [];
      var contents = [];
      //dummy object used to test to see if the for loop worked.
      var data = [
        {
          name: 'Crunch',
          latitude: -34.397,
          longitude: 150.644,
          description: {
            content: 'Crunch Gym',
            reviews: 'this place is the shit',
            distanceFromHome: 10,
            distanceFromWork: 5
          },
        },
        {
          name: 'Crunch',
          latitude: -39.397,
          longitude: 150.644,
          description: {
            content: 'Crunch Gym',
            reviews: 'this place is the shit',
            distanceFromHome: 10,
            distanceFromWork: 5
          }
        }
      ];

      function initMap() {
        var myLatLng1 = {lat: -34.397, lng: 150.644};
        var myLatLng2 = {lat: -34.597, lng: 150.644};
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: -34.397, lng: 150.644},
          zoom: 8
        });
        //cycles over the data obj and then extracts info as needed
      for (var i = 0; i < data.length; i++) {
        var position = new google.maps.LatLng(data[i].latitude, data[i].longitude);
        markers[i] = new google.maps.Marker({
          position: position,
          map: map,
          description: data[i].description,
          id: i
        });

        //doesn't work
        var infoWindow = new google.maps.InfoWindow({
          content: markers[i].description.content,
          reviews: markers[i].description.reviews,
          distanceFromHome: markers[i].description.distanceFromHome,
          distanceFromWork: markers[i].description.distanceFromWork
        });

        // var infoWindow = new google.maps.InfoWindow({
        //   content: data[i].name
        // });


        //goes to the current marker, and then displays all of the info in the description.
        google.maps.event.addListener(markers[i], 'click', function() {
          infoWindow.open(map, markers[i]);
          map.panTo(markers[i].getPosition());
          console.log(markers[this.id].description);
          for (var key in markers[this.id].description) {
            alert(markers[this.id].description[key]);
          }
          // alert(markers[this.id].description);

          // console.log(data[0].description.content)
          console.log(markers[this.id].description);
        })
      }


        // var marker1 = new google.maps.Marker({
        //   position: myLatLng1,
        //   map: map,
        //   title: 'Hello World!'
        // });
        // var marker2 = new google.maps.Marker({
        //   position: myLatLng2,
        //   map: map,
        //   title: 'Hello World!'
        // });



        // marker1.addListener('click', function() {
        //   infowindow.open(map, marker1);
        // });
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAvXHQtnUPWtvPzT2M3u2VD1Pxqi7ihyfQ&callback=initMap"
    async defer></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular.min.js"></script>
    <script src="app.js"></script>
  </body>
</html>
